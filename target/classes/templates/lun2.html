<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        ul,ol{
            list-style: none;
        }
        img{
            vertical-align: top;
        }
        .scroll{
            width: 500px;
            height: 200px;
            margin: 100px auto 0px;
            border: 1px solid #ccc;
            padding: 7px;
            overflow: hidden;
            position: relative;
        }
        .box{
            width: 500px;
            height: 200px;
            overflow: hidden;
            position: relative;
        }
        .box ul{
            width: 600%;
            position: absolute;
            left: 0px;
            top: 0;
        }
        .box ul li{
            float: left;
        }
        .scroll ol{
            position: absolute;
            right: 10px;
            bottom: 10px;

        }
        .scroll ol li{
            float: left;
            width: 20px;
            height: 20px;
            background: pink;
            text-align: center;
            line-height: 20px;
            border-radius: 50%;
            background-color: pink;             
            margin-left:10px ;
            cursor: pointer;
        }
        .scroll ol li.current{
            background-color: purple;
        }
        .con{
            margin: 0 auto;
            width: 100px;
        }
    </style>
</head>
<body>
        <div id="scroll" class="scroll">
            <div id="box" class="box">
                <ul id="ul">
                    <li><img src="../image/l01.jpg" width="500" height="200"></li>
                    <li><img src="../image/l02.jpg" width="500" height="200"></li>
                    <li><img src="../image/l03.jpg" width="500" height="200"></li>
                    <li><img src="../image/l04.png" width="500" height="200"></li>
                    <li><img src="../image/l05.jpg" width="500" height="200"></li>
                </ul>
            </div>
        </div>
        <div class="con">
            <button id="shang">上一个</button>
            <button id="xia">下一个</button> 
        </div>
</body>
<script>
   var scroll = document.getElementById("scroll"); // 获得大盒子
    var ul = document.getElementById("ul"); // 获得ul
    var ulLis = ul.children;// 获得ul的盒子 以此来生成ol中li的个数
    var liWidth = ul.children[0].offsetWidth;// 获得每个li的宽度
    // 操作元素
    // 因为要做无缝滚动，所以要克隆第一张，放到最后一张后面
    // 1. 克隆元素
    ul.appendChild(ul.children[0].cloneNode(true));

    // 2.创建ol 和li
    var ol = document.createElement("ol");//创建ol元素
    ol.setAttribute("id","ol")
    scroll.appendChild(ol);// 把ol放到scroll盒子里面去
    for (var i=0;i<ulLis.length-1;i++) {
        var li = document.createElement("li");// 创建li元素
        li.innerHTML = i + 1;// 给li里面添加文字  1 2 3 4 5
        ol.appendChild(li);// 将li元素添加到ol里面
    }
    ol.children[0].className = "current";// ol中的第一个li背景色为purple

    // 动画函数 第一个参数，代表谁动  第二个参数 动多少
    // 让图片做匀速运动，匀速动画的原理是 当前的位置 + 速度  即 offsetLeft + speed

    function animate(obj,target){
        // 首先清除掉定时器
        clearInterval(obj.timer);
        // 用来判断 是+ 还是 -  即说明向左走还是向右走
        var speed = obj.offsetLeft < target ? 15 : -15;
        obj.timer = setInterval(function(){
            var result = target - obj.offsetLeft;//它们的差值不会超过speed
            obj.style.left = obj.offsetLeft + speed + "px";
            // 有可能有小数的存在，所以在这里要做个判断             
            if (Math.abs(result) <= Math.abs(speed)) {
                clearInterval(obj.timer);
                obj.style.left = target + "px";
            }
        },10);
    }



    var ol = document.getElementById("ol");
    var olLis = ol.children;
    var timer = null; // 轮播图的定时器
    var key = 0;// 控制播放的张数
    var circle = 0;// 控制小圆点

    timer = setInterval(autoplay,1000);// 自动轮播
    function autoplay(){
        /*自动轮播时,要对播放的张数key进行一个判断,如果播放的张数超过ulLis.length-1,
        就要重头开始播放.  因为我们克隆了第一张并将其放在最后面,所以我们要从第二张图片开始播放*/
        key++; // 先++
        if(key > ulLis.length-1){// 后判断

            ul.style.left = 0; // 迅速调回
            key = 1; // 因为第6张是第一张，所以播放的时候是从第2张开始播放
        }
        // 动画部分
        animate(ul,-key*liWidth);

        // 小圆点circle   当显示第几张图片是，对应的小圆点的颜色也发生变化 

        /*同理,对小圆点也要有一个判断*/
        circle++;
        if (circle > olLis.length-1) {
            circle = 0;
        }
        // 小圆点颜色发生变化
        for (var i = 0 ; i < olLis.length;i++) {
            // 先清除掉所用的小圆点类名
            olLis[i].className = ""; 
        }
        // 给当前的小圆点 添加一个类名
        olLis[circle].className = "current";
        console.log(key);

    }




    var shang = document.getElementById("shang");
    shang.onmouseover = function(){
        // clearInterval(timer);
    }
    shang.onclick = function(){
        key = key-2;
        circle = circle-2;
        // timer = setInterval(autoplay,1000);
    }
    shang.onmouseout = function(){
    }



    var xia = document.getElementById("xia");
    xia.onmouseover = function(){
        // clearInterval(timer);
    }
    xia.onclick = function(){
        key = key+0;
        circle = circle+0;
        // timer = setInterval(autoplay,1000);
    }
    xia.onmouseout = function(){
        // timer = setInterval(autoplay,1000);
    }
</script>
</html>